node {
	stage('checkout') {
	    checkout scm
	}	
	stage('build') {
		chmod 777 gradlew
		sh './gradlew clean build'
	}
	stage('buildDockerImage') {
		withCredentials([[$class: 'UsernamePasswordMultiBinding', credentialsId: "DOCKER", usernameVariable: 'DOCKERUSER', passwordVariable: 'DOCKERPASS']]) {
			sh "docker login -u ${DOCKERUSER} -p ${DOCKERPASS}"
			sh 'docker build  . -t csubbum/calculator:latest'
			sh 'docker push csubbum/calculator:latest'
		}
	}
}
